[gd_scene load_steps=6 format=2]

[ext_resource path="res://Graphics/GameObjects/Switch/switch_top.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends StaticBody2D

# class member variables go here, for example:
# var a = 2
# var b = \"textvar\"
signal  switch_on
signal  switch_off

export var state = false 
export var isSticky = false 

var switchArea
var trigger

func _ready():

	self.switchArea = self.get_node(\"GrooveJoint2D/switch\");
	self.trigger = self.get_node(\"GrooveJoint2D/trigger\");
	set_process( true );

func _process(delta):
	var isOn = self.isOn(); 
	if(self.state != isOn):
		if(isOn):
			self.emit_signal('switch_on');
			if(self.isSticky):
				self.switchArea.set_sleeping(true)
				self.switchArea.set_contact_monitor(false)
		else:
			self.emit_signal('switch_off');
		
	self.state = isOn;

func isOn():
	return self.trigger.overlaps_body( self.switchArea  );


"

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 31.8826, 4.05268 )

[sub_resource type="RectangleShape2D" id=3]
extents = Vector2( 31.8826, 4.16562 )

[sub_resource type="RectangleShape2D" id=4]

[node name="ToggleSwitch" type="StaticBody2D"]
script = SubResource( 1 )

[node name="GrooveJoint2D" type="GrooveJoint2D" parent="."]
position = Vector2( 0, -50 )
node_a = NodePath("..")
node_b = NodePath("switch")

[node name="switch" type="RigidBody2D" parent="GrooveJoint2D"]
position = Vector2( 1.26868, -2.67352 )
mode = 2
gravity_scale = -1.0

[node name="Sprite" type="Sprite" parent="GrooveJoint2D/switch"]
position = Vector2( -1.0847, 8.58826 )
scale = Vector2( 0.2, 0.2 )
texture = ExtResource( 1 )

[node name="Collision" type="CollisionShape2D" parent="GrooveJoint2D/switch"]
position = Vector2( -0.25, 4.75 )
shape = SubResource( 2 )

[node name="trigger" type="Area2D" parent="GrooveJoint2D"]
position = Vector2( 0, 33.7845 )
scale = Vector2( 1, 0.496352 )

[node name="triggerCollision" type="CollisionShape2D" parent="GrooveJoint2D/trigger"]
position = Vector2( -0.077961, 0.648625 )
scale = Vector2( 1.03009, 7.03056 )
shape = SubResource( 3 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( 3.08518, -15.075 )
scale = Vector2( 3.01172, 1.39018 )
shape = SubResource( 4 )
